# 服务器搭建

### 1项目初始化，以及安装express

>```
>yarn init -y 
>yarn add express
>```
>
>2在项目文件下编写入口文件 app.js，注意跨域post请求必须加上 app.use(express.json());
>
>```
>const express=require("express")
>const cors= require("cors")
>
>
>const app=express()
>app.use(cors())
>app.use(express.json());
>
>
>app.post("/login",(req,res)=>{
>    // {data,meta={msg,status}}=res.data  
>    let {password,username}=req.body
>    console.log(req.body)
>  
>    if(!username||!password){
>        let result={
>            data:{
>                username: "",
>                password: "",
>                mobile: "",
>                email: "",
>                rid:"",
>                token:""
>            },
>            meta:{
>                msg:"参数错误，请正确填写账号密码",
>                status:301
>            }
>        }
>      
>        res.send(result)
>    }
>    if(username=="admin"&&password=="123456"){
>    console.log(password,username)
>
>        let result={    
>            data:{
>                username: "admin",
>                password: 123456,
>                mobile: "181xxxxx327",
>                email: "admin@xx.com",
>                id: 1,
>                rid:30,
>                token:"00000"
>            },
>            meta:{
>                msg:"登录成功",
>                status:201
>            }
>            
>        }
>        console.log(result)
>       
>         res.send(result)
>    }
>       
>    
>})
>
>app.listen(3000,()=>{
>    console.log("正在监听3000端口")
>})
>```
>
>

### 2数据库操作

>新建db文件夹，该文件夹下有一个handleDB.js（用于操作数据库）和一个nodejs-orm文件夹（其中包含数据库配置文件index.js）
>
>2.1安装 mysql包
>
>```
>yarn add mysql
>```
>
>2.2 在app.js中引入,编写接口
>
>```
>const handleDB=require("./db/handleDB")
>
>app.get("/users",(req,res)=>{
>    (async function(){
>        // 接受参数
>        // pageNum 当前页码 不能为空
>        // pageSize 每页显示条数 不能为空
>       let {pageNum,pageSize}=req.query
>       console.log(req.query)
>       console.log(pageNum,pageSize)
>
>       let users= await handleDB(res,"user","sql","数据库查询出错","select username,password_hash,mobile,email,create_time from user") 
>       let total= await handleDB(res,"user","sql","数据库查询出错","select count(*) from user") 
>    //    返回参数
>        let result={
>            data:{
>                users,
>                total:total[0]['count(*)']
>            },
>            meta:{
>                status:200,
>                msg:"获取数据库成功"
>            }
>        }
>       console.log(result)
>       res.send(result)
>    })()
>})
>```
>

### 3 使用JSON web token

>1.安装jsonwebtoken
>
>```
>yarn add jsonwebtoken

>2 在app.js 中写一个接口
>
>
